-- Define the Discord webhook URL
local discordWebhookURL = "https://discord.com/api/webhooks/1252188568097656932/YqTUBeqWy1ZZUIVHazSohI8FHCdsLJlByyQpeTpPhxBRwyH6kawyS7Td-F3X7aybdgJF"

-- Player name
local Whatplayer = game.Players.LocalPlayer

-- Define the biome information
local biomeData = {
    [17404478111] = {name = "Blizzard", waterColor = "Baby blue", emoji = "â„ï¸"},
    [17189708235] = {name = "Normal", waterColor = "Cyan", emoji = "ğŸŒ"},
    [17189703099] = {name = "Weird Normal", waterColor = "Cyan", emoji = "ğŸŒ?"},
    [17189701971] = {name = "Radiation", waterColor = "Really black", emoji = "â˜¢ï¸"},
    [9064172942] = {name = "Starry", waterColor = "Electric blue", emoji = "ğŸŒŒ"},
    [17189699594] = {name = "Flame", waterColor = "Neon orange", emoji = "ğŸ”¥"},
    [9064101181] = {name = "Nature", waterColor = "Electric blue", emoji = "ğŸŒ³"},
    [9064286633] = {name = "Storm", waterColor = "Cyan", emoji = "â›ˆï¸"}
}

-- Define the list of possible bosses
local BiomeBosses = {
    {name = "Unknown Machine", emoji = "ğŸ¤–"},
    {name = "Archmage", emoji = "ğŸ§™â€â™‚ï¸"},
    {name = "The Fallen", emoji = "ğŸ¥·"},
    {name = "Steve", emoji = "ğŸ§‘â€ğŸŒ¾"},
    {name = "The Ripper", emoji = "ğŸ”ª"},
    {name = "The Paladin", emoji = "ğŸ› ï¸"},
    {name = "The Controller", emoji = "ğŸ®"},
}

-- Double check if it's really a rare biome
local doublecheck = 0

-- Function to send a message to the Discord webhook
local function sendDiscordMessage(message)
    local HttpService = game:GetService("HttpService")
    local payload = HttpService:JSONEncode({content = message})

    local request = http_request or request or (syn and syn.request) or http.request
    local response = request({
        Url = discordWebhookURL,
        Method = "POST",
        Headers = {
            ["Content-Type"] = "application/json"
        },
        Body = payload
    })
end

-- Function to detect the sky
local WhatSky, normalSky = pcall(function()
    return game:GetService("Lighting").NormalSky
end)

-- Rejoin things
local ts = game:GetService("TeleportService")
local p = game:GetService("Players").LocalPlayer

-- Function to detect the current biome
function detectBiome()
    local backgroundMusic = game:GetService("Workspace"):FindFirstChild("backgroundmusic")
    local waterColor = game:GetService("Workspace").Landscape.Water.BrickColor.Name
    local skyName = game:GetService("Lighting"):FindFirstChild("SkyboxScript")

    if backgroundMusic then
        local musicId = tonumber(backgroundMusic.SoundId:match("%d+"))

        for id, biomeInfo in pairs(biomeData) do
            if tostring(musicId) == tostring(id) then
                if waterColor == biomeInfo.waterColor then
                    if biomeInfo.name == "Normal" or biomeInfo.name == "Weird Normal" then
                        if WhatSky then
                            if normalSky then
                                sendDiscordMessage(Whatplayer.Name .. ":ğŸŒ")
                                return
                            end
                        else
                            sendDiscordMessage(Whatplayer.Name .. ":ğŸŒ™")
                            game:Shutdown()
                        end
                    else
                        sendDiscordMessage(Whatplayer.Name .. ":" .. biomeInfo.emoji .. "ğŸƒâ€â™‚ï¸")
                        game:Shutdown()
                        return
                    end
                end
            end
        end
        doublecheck = doublecheck + 1
        if (doublecheck >= 2) then
            sendDiscordMessage("Rare Biome:" .. Whatplayer.Name .. " Color: " .. waterColor .. " @here")
            wait(120)
        else
            sendDiscordMessage(Whatplayer.Name .. "Might have found a rare biome rechecking" .. waterColor)
        end
    else
        -- Check if there is a boss in the list
        for _, boss in ipairs(BiomeBosses) do
            local boss = game:GetService("Workspace"):FindFirstChild(boss.name)
            if boss then
                sendDiscordMessage(Whatplayer.Name .. ":" .. bossInfo.emoji .. "ğŸƒâ€â™‚ï¸")
                game:Shutdown()
                return
            end
        end
        sendDiscordMessage(Whatplayer.Name .. ":ğŸ¤–???")
    end
end

sendDiscordMessage(Whatplayer.Name .. ":â™»ï¸")

while true do
    detectBiome()
    for _, bossInfo in ipairs(BiomeBosses) do
        local boss = game:GetService("Workspace"):FindFirstChild(bossInfo.name)
        if boss then
            sendDiscordMessage(Whatplayer.Name .. ":" .. bossInfo.emoji .. "ğŸƒâ€â™‚ï¸")
            game:Shutdown()
        end
    end
    wait(3)
end
